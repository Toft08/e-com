<div class="profile-container">
  <!-- Header with User Info -->
  <div class="profile-header">
    <div class="user-info">
      <div class="avatar-section">
        <div class="avatar" *ngIf="!avatarUrl">{{ getInitials() }}</div>
        <img *ngIf="avatarUrl" [src]="avatarUrl" alt="Profile avatar" class="avatar-image" />
        <div class="avatar-actions" *ngIf="isSeller()">
          <input
            type="file"
            #avatarFileInput
            accept="image/jpeg,image/jpg,image/png,image/gif,image/webp"
            (change)="onAvatarFileSelected($event)"
            class="file-input-hidden"
          />
          <button
            class="btn-avatar-action"
            (click)="avatarFileInput.click()"
            [disabled]="isUploadingAvatar"
          >
            {{ avatarUrl ? 'üì∑' : '‚ûï' }}
          </button>
          <button
            *ngIf="avatarUrl"
            class="btn-avatar-action btn-delete"
            (click)="deleteAvatar()"
            [disabled]="isUploadingAvatar"
          >
            üóëÔ∏è
          </button>
        </div>
        <div *ngIf="isUploadingAvatar" class="avatar-loading">Uploading...</div>
        <div *ngIf="avatarError" class="avatar-error">{{ avatarError }}</div>
      </div>
      <div class="user-details">
        <h1>{{ currentUser?.name }}</h1>
        <p class="email">{{ currentUser?.email }}</p>
        <span class="role-badge" [ngClass]="'role-' + currentUser?.role">
          {{ currentUser?.role === 'seller' ? 'Seller' : 'Buyer' }}
        </span>
      </div>
    </div>
  </div>

  <!-- Seller View: Products for Sale -->
  <div *ngIf="isSeller()" class="seller-section">
    <div class="section-header">
      <h2>My Products for Sale</h2>
      <a routerLink="/seller/dashboard" class="btn btn-primary">Manage Products</a>
    </div>

    <div *ngIf="isLoading" class="loading">Loading your products...</div>

    <div *ngIf="!isLoading && sellerProducts.length === 0" class="empty-state">
      <p>You haven't listed any products yet.</p>
      <a routerLink="/seller/dashboard" class="btn btn-primary">Create Your First Product</a>
    </div>

    <div *ngIf="!isLoading && sellerProducts.length > 0" class="products-grid">
      <div *ngFor="let product of sellerProducts" class="product-card">
        <div class="product-image">
          <app-image-slider
            *ngIf="getProductImages(product.id!).length > 0"
            [images]="getProductImages(product.id!)"
            [alt]="product.name"
          ></app-image-slider>
          <div *ngIf="getProductImages(product.id!).length === 0" class="no-image">No Image</div>
        </div>
        <div class="product-info">
          <h3>{{ product.name }}</h3>
          <p class="description">{{ product.description | slice : 0 : 60 }}...</p>
          <div class="product-meta">
            <span class="price">${{ product.price | number : '1.2-2' }}</span>
            <span class="quality">Quality: {{ product.quality }}/5</span>
          </div>
          <div class="product-actions">
            <a
              [routerLink]="['/seller/dashboard']"
              [queryParams]="{ productId: product.id }"
              class="btn btn-sm btn-secondary"
            >
              Edit
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Buyer View: Shopping Cart (Coming Soon) -->
  <div *ngIf="isBuyer()" class="buyer-section">
    <div class="section-header">
      <h2>My Shopping Cart</h2>
      <a routerLink="/products" class="btn btn-primary">Browse Products</a>
    </div>

    <div class="coming-soon-section">
      <div class="coming-soon-icon">üõí</div>
      <h3>Shopping Cart Coming Soon!</h3>
      <p>
        We're working hard to bring you a complete shopping experience. Full cart functionality,
        checkout, and order management will be available in an upcoming update.
      </p>
      <div class="coming-soon-features">
        <div class="feature">‚úì Add products to cart</div>
        <div class="feature">‚úì Manage quantities</div>
        <div class="feature">‚úì Secure checkout</div>
      </div>
      <a routerLink="/products" class="btn btn-primary">Explore Products</a>
    </div>
  </div>
</div>
